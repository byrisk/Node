port: 7890
allow-lan: true
bind-address: '*'
mode: rule
log-level: info
unified-delay: true
global-client-fingerprint: chrome
external-controller: :9090

dns:
  enable: true
  ipv6: false
  enhanced-mode: fake-ip
  listen: 0.0.0.0:7874
  nameserver:
    - tls://1.1.1.1
    - tls://8.8.8.8
    - https://cloudflare-dns.com/dns-query
  default-nameserver:
    - 119.29.29.29
    - 223.5.5.5
  fallback:
    - tls://1.0.0.1:853
    - tls://8.8.4.4:853
  fallback-filter:
    geoip: true
    geoip-code: CN
    ipcidr:
      - 240.0.0.0/4
  fake-ip-range: 198.18.0.1/16
  fake-ip-filter:
    - '*.lan'
    - 'localhost.ptlogin2.qq.com'
    - 'dns.msftncsi.com'
    - 'www.msftncsi.com'
    - 'www.msftconnecttest.com'

### é”šç‚¹å®šä¹‰
fly: &fly 
  type: url-test
  url: "http://www.google.com/generate_204"
  interval: 300
  tolerance: 50
  lazy: true

fly2: &fly2 
  type: url-test
  url: "http://www.google.com/generate_204"
  interval: 300
  tolerance: 50
  lazy: true

all: &all 
  type: select

p: &p 
  type: http
  interval: 21600
  health-check: 
    enable: true
    url: "http://www.google.com/generate_204"
    interval: 1800
    filter: "(?i)^(?!unavailable).*$"

### ä»£ç†æä¾›å•†
proxy-providers:
  è®¢é˜…1:
    <<: *p
    url: "https://gist.githubusercontent.com/byrisk/904fcf74c6299b728fb2b83d621832dd/raw/a99002f6e03bc9eca0d7ea4a4af533f0dd8a8760/MQconfig"
    path: ./providers/è®¢é˜…1.yaml

  è®¢é˜…2:
    <<: *p
    url: "https://gist.githubusercontent.com/byrisk/172280d15a99a420c2ec0d190be8e40a/raw/515ae2eddd954116eee7330af025e617b084a7fa/all.yaml"
    path: ./providers/è®¢é˜…2.yaml

  è®¢é˜…3:
    <<: *p
    url: "https://linuxdo.862368.xyz/proxy.php"  # æ”¹ä¸ºHTTPS
    path: ./providers/è®¢é˜…3.yaml

### ä»£ç†ç»„
proxy-groups:
  - name: ğŸš€ è‡ªåŠ¨é€‰æ‹©(æ¨è_è‡ªç”¨é«˜é€Ÿ)
    <<: *fly
    use: [è®¢é˜…1]
    filter: "(?i)^(?!unavailable).*$"
  
  - name: ğŸš€èŠ‚ç‚¹é€‰æ‹©(æ¨è_è‡ªç”¨é«˜é€Ÿ)
    <<: *all
    use: [è®¢é˜…1]
    filter: "(?i)^(?!unavailable).*$"
  
  - name: ğŸš€ è‡ªåŠ¨é€‰æ‹©(å¤‡ç”¨)
    <<: *fly2
    use: [è®¢é˜…2, è®¢é˜…3]
    filter: "(?i)^(?!unavailable).*$"

  - name: ğŸŒï¸ èŠ‚ç‚¹é€‰æ‹©(All)
    <<: *all
    use: [è®¢é˜…1, è®¢é˜…2, è®¢é˜…3]
    filter: "(?i)^(?!unavailable).*$"

  - name: ğŸ”€ AI æœåŠ¡
    type: select
    proxies:
      - âœ… è§£é” AI
      - DIRECT

  - name: âœ… è§£é” AI
    type: url-test
    url: "http://www.google.com/generate_204"
    interval: 120
    tolerance: 50
    lazy: true
    use: [è®¢é˜…1, è®¢é˜…2, è®¢é˜…3]
    filter: "(?!.*(hong kong|hk|é¦™æ¸¯|é¦™|æ¸¯|é¦™æ¸¯ 01))"

  - name: â›”ï¸ æ‹¦æˆªå¹¿å‘Š
    type: select
    proxies:
      - REJECT
      - DIRECT

  - name: â†ªï¸ æ¼ç½‘ä¹‹é±¼
    type: select
    proxies:
      - ğŸŒï¸ èŠ‚ç‚¹é€‰æ‹©(All)
      - ğŸš€èŠ‚ç‚¹é€‰æ‹©(æ¨è_è‡ªç”¨é«˜é€Ÿ)
      - ğŸš€ è‡ªåŠ¨é€‰æ‹©(æ¨è_è‡ªç”¨é«˜é€Ÿ)
      - DIRECT

### è§„åˆ™
rules:
  # AIæœåŠ¡
  - DOMAIN-SUFFIX,openai.com,ğŸ”€ AI æœåŠ¡
  - DOMAIN-SUFFIX,anthropic.com,ğŸ”€ AI æœåŠ¡
  - DOMAIN-SUFFIX,claude.ai,ğŸ”€ AI æœåŠ¡
  - DOMAIN-SUFFIX,gemini.google.com,ğŸ”€ AI æœåŠ¡
  - DOMAIN-KEYWORD,openai,ğŸ”€ AI æœåŠ¡
  - RULE-SET,ai,ğŸ”€ AI æœåŠ¡

  # å¹¿å‘Šæ‹¦æˆª
  - RULE-SET,reject,â›”ï¸ æ‹¦æˆªå¹¿å‘Š
  - DOMAIN-SUFFIX,adobe.io,REJECT
  - DOMAIN-SUFFIX,adobestats.io,REJECT

  # å›½å†…ç›´è¿
  - RULE-SET,private,DIRECT
  - RULE-SET,cncidr,DIRECT
  - RULE-SET,china,DIRECT
  - GEOIP,CN,DIRECT

  # ä»£ç†è§„åˆ™
  - RULE-SET,proxy,ğŸŒï¸ èŠ‚ç‚¹é€‰æ‹©(All)
  - RULE-SET,gfw,ğŸŒï¸ èŠ‚ç‚¹é€‰æ‹©(All)
  - RULE-SET,tld-not-cn,ğŸŒï¸ èŠ‚ç‚¹é€‰æ‹©(All)

  # æœ€ç»ˆè§„åˆ™
  - MATCH,â†ªï¸ æ¼ç½‘ä¹‹é±¼

### è§„åˆ™é›†
rule-providers:
  ai:
    type: http
    behavior: domain
    url: "https://cdn.jsdelivr.net/gh/Loyalsoldier/clash-rules@release/ai.txt"
    path: ./ruleset/ai.yaml
    interval: 86400

  reject:
    type: http
    behavior: domain
    url: "https://cdn.jsdelivr.net/gh/Loyalsoldier/clash-rules@release/reject.txt"
    path: ./ruleset/reject.yaml
    interval: 86400

  private:
    type: http
    behavior: domain
    url: "https://cdn.jsdelivr.net/gh/Loyalsoldier/clash-rules@release/private.txt"
    path: ./ruleset/private.yaml
    interval: 86400

  cncidr:
    type: http
    behavior: ipcidr
    url: "https://cdn.jsdelivr.net/gh/Loyalsoldier/clash-rules@release/cncidr.txt"
    path: ./ruleset/cncidr.yaml
    interval: 86400

  china:
    type: http
    behavior: domain
    url: "https://cdn.jsdelivr.net/gh/Loyalsoldier/clash-rules@release/china.txt"
    path: ./ruleset/china.yaml
    interval: 86400

  proxy:
    type: http
    behavior: domain
    url: "https://cdn.jsdelivr.net/gh/Loyalsoldier/clash-rules@release/proxy.txt"
    path: ./ruleset/proxy.yaml
    interval: 86400

  gfw:
    type: http
    behavior: domain
    url: "https://cdn.jsdelivr.net/gh/Loyalsoldier/clash-rules@release/gfw.txt"
    path: ./ruleset/gfw.yaml
    interval: 86400

  tld-not-cn:
    type: http
    behavior: domain
    url: "https://cdn.jsdelivr.net/gh/Loyalsoldier/clash-rules@release/tld-not-cn.txt"
    path: ./ruleset/tld-not-cn.yaml
    interval: 86400
